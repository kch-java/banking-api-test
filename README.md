# Bank API

## Оглавление
1. [Обзор проекта](#обзор-проекта)
2. [Используемые технологии](#используемые-технологии)
3. [Принятые решения](#принятые-решения)
4. [Документация API](#документация-API)
5. [Эндпойнты API](#эндпоинты-api)
6. [Запуск приложения](#запуск-приложения)
7. [База данных](#база-данных)
8. [Миграция базы данных](#миграция-базы-данных)
9. [Начальное заполнение БД](#начальное-заполнение-базы-данных)

## Обзор проекта

Это API для банковского приложения, которое позволяет пользователям создавать банковские счета, осуществлять депозиты, снимать деньги со счета, переводить деньги с одного счета на другой и просматривать транзакции по счету.

## Используемые технологии

- **Spring Boot**: основной фреймворк приложения.
- **H2 Database**: встроенная база данных, используемая для хранения информации о счетах и транзакциях.
- **Maven**: инструмент сборки и управления зависимостями.
- **Swagger**: используется для документирования API.

## Принятые решения

В этом разделе объясняются некоторые из решений, принятых при проектировании и реализации этого приложения.

### Архитектурные решения

Приложение разделено на слои сервисов и репозиториев, что позволяет изолировать бизнес-логику от доступа к данным. Для передачи данных между слоями используются объекты DTO (Data Transfer Objects), а для преобразования сущностей в DTO и обратно используются мапперы.

### Выбор технологий

Для реализации приложения были выбраны следующие технологии:

- **Spring Boot**: основной фреймворк приложения, выбран за его простоту и мощные возможности для создания веб-приложений.
- **H2 Database**: встроенная база данных, выбрана за ее простоту и удобство использования в тестовых и разработческих средах.
- **Maven**: инструмент сборки и управления зависимостями, выбран за его широкое распространение и поддержку в сообществе.
- **Swagger**: используется для документирования API, выбран за его простоту и возможность генерации интерактивной документации.

### Валидация входных данных

Входные данные для API валидируются в сервисном слое приложения. Это решение было принято, чтобы обеспечить гибкость в обработке ошибок и предоставить возможность более детального контроля над процессом валидации.

### Обработка ошибок

Приложение использует пользовательские исключения для обработки различных ошибочных ситуаций, таких как "счет не найден" или "недостаточный баланс". Это позволяет ясно и точно сообщать о проблемах, а также обеспечивает возможность гибко обрабатывать различные типы ошибок. Вместо того чтобы полагаться на общие исключения, которые могут быть не очень информативными, пользовательские исключения позволяют нам точно указать, что пошло не так, что упрощает отладку и улучшает пользовательский опыт.

### Тестирование

Приложение включает модульные тесты для сервисного слоя, чтобы убедиться, что бизнес-логика работает правильно. В будущем планируется добавить тесты для других слоев приложения, включая контроллеры и репозитории.

## Документация API

Документация API доступна через Swagger UI. Вы можете получить доступ к ней, перейдя по следующему URL после запуска приложения:


http://localhost:8080/swagger-ui.html


Это предоставит вам интерактивный интерфейс, где вы можете просмотреть доступные эндпоинты API, их параметры, ответы и т.д.

## Эндпоинты API

- `POST /api/accounts`: Создает новый банковский счет.
- `GET /api/accounts/{id}`: Возвращает информацию о счете по его ID.
- `POST /api/accounts/{id}/deposit`: Осуществляет депозит на счет.
- `POST /api/accounts/{id}/withdraw`: Снимает деньги со счета.
- `POST /api/accounts/{id}/transfer`: Переводит деньги с одного счета на другой.
- `GET /api/accounts/{id}/transactions`: Возвращает список транзакций по счету.
- `GET /api/accounts`: Возвращает информацию обо всех счетах. Можно добавить параметр запроса `beneficiaryName` для фильтрации счетов по имени бенефициария.

## Запуск приложения

Для запуска приложения выполните следующую команду:


./mvnw spring-boot:run


После запуска приложения вы можете получить доступ к API по адресу `http://localhost:8080/api/accounts` и к документации Swagger по адресу `http://localhost:8080/swagger-ui.html`.

## База данных

Приложение использует встроенную базу данных H2. Вы можете получить доступ к консоли H2, перейдя по следующему URL после запуска приложения:


http://localhost:8080/h2-console


Пожалуйста, убедитесь, что JDBC URL в консоли H2 соответствует URL вашей базы данных H2, который указан в файле `application.yml` вашего проекта.

## Миграция базы данных

Приложение использует Flyway для миграции базы данных. Миграции находятся в директории `src/main/resources/db/migration`.

В настоящее время существуют следующие миграции:

- `V1__Initial_schema.sql`: Создает начальную схему базы данных, включая таблицы `account` и `transaction`.
- `V2__Seed_accounts.sql`: Добавляет начальные данные в таблицу `account`.

Приложение автоматически применяет эти миграции при запуске. Дополнительную информацию о работе с Flyway можно найти в официальной документации Flyway.

## Начальное заполнение базы данных

Приложение автоматически заполняет базу данных начальными данными при запуске. Это включает создание нескольких банковских счетов с различными балансами. Вы можете найти детали в файле миграции `V2__Seed_accounts.sql`.